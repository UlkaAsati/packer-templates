#!/usr/bin/env bash

set -o errexit

main() {
  local envdir="${1}"
  mkdir -p "${envdir}"
  printenv | grep -E 'DOCKER_LOGIN_(USERNAME|PASSWORD|SERVER)' | while read vardef ; do
    echo "${vardef##*=}" > "${envdir}/${vardef//=*/}"
  done
  touch "${envdir}/.dumped"
}

main "$@"
